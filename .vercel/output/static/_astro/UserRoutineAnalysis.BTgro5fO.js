import{j as e}from"./jsx-runtime.ojTTAiD7.js";import{r as i}from"./index.Dck49-wq.js";const D=()=>{const[m,u]=i.useState([]),[c,h]=i.useState([]),[n,g]=i.useState(""),[l,y]=i.useState(""),j=async()=>{try{const a=(o=>{const d=`; ${document.cookie}`.split(`; ${o}=`);if(d.length===2)return d.pop()?.split(";").shift()})("jwtToken");if(!a)throw new Error("No token found in cookies");const s=await fetch("http://localhost:8080/rutinaUsuario/get",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.trim()}`}});if(!s.ok)throw console.error("Error fetching routines:",s),new Error("Error fetching routines");const r=await s.json();u(r),h(r)}catch(t){console.error("Error fetching routines:",t)}};i.useEffect(()=>{j()},[]),i.useEffect(()=>{if(n&&l){const t=m.filter(a=>{const s=new Date(a.fechaRutina);return s>=new Date(n)&&s<=new Date(l)});h(t)}else h(m)},[n,l,m]);const f=()=>c.length===0?0:(c.reduce((a,s)=>a+parseFloat(s.kilometrajeRecorrido),0)/c.length).toFixed(2),x=(()=>{const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],a={};return t.forEach(s=>{const r=c.filter(o=>o.diaSemana===s);if(r.length>0){const o=r.reduce((p,d)=>p+parseFloat(d.kilometrajeRecorrido),0);a[s]=parseFloat((o/r.length).toFixed(2))}else a[s]=0}),a})(),w=[...c].sort((t,a)=>parseFloat(a.kilometrajeRecorrido)-parseFloat(t.kilometrajeRecorrido)),b=Object.entries(x).sort(([,t],[,a])=>a-t);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{title:"Start Date",type:"date",value:n,onChange:t=>g(t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{title:"End Date",type:"date",value:l,onChange:t=>y(t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg",children:[e.jsxs("table",{className:"min-w-full min-h-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-[#0891b2] hover:bg-cyan-500",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Day of the Week"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Activity"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Kilometraje Recorrido (km)"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[w.map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(t.fechaRutina).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.diaSemana}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.actividad}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.kilometrajeRecorrido})]},a)),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",colSpan:3,children:"Average Kilometraje per Day"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[f()," km"]})]})]})]}),e.jsxs("div",{className:"mt-6 bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4 border-b-2 border-gray-300 pb-2",children:"Average Kilometraje by Day of the Week"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:b.map(([t,a],s)=>{const r=Math.min(...Object.values(x)),o=a===r;return e.jsxs("div",{className:`p-4 rounded-md shadow-sm transition-colors ${o?"bg-[#16a34a] text-white hover:bg-green-500":"bg-[#0891b2] hover:bg-cyan-500"}`,children:[e.jsx("h4",{className:"font-semibold text-white",children:t}),e.jsxs("p",{className:"text-white",children:[a," km"]})]},s)})})]})]})]})};export{D as default};
