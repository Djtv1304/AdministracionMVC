import{j as e}from"./jsx-runtime.ojTTAiD7.js";import{r as o}from"./index.Dck49-wq.js";const k=()=>{const[h,p]=o.useState([]),[i,x]=o.useState(""),[n,u]=o.useState([]),[s,f]=o.useState({kilometraje:0,bateriaInicial:0,bateriaFinal:0}),c=t=>{const{name:r,value:a}=t.target;f({...s,[r]:a})},g=async t=>{t.preventDefault();const r={idVehiculo:i,fecha:new Date().toISOString(),kilometraje:s.kilometraje,bateriaInicial:s.bateriaInicial,bateriaFinal:s.bateriaFinal,rendimiento:0};try{const a=await fetch("http://localhost:8080/registroRendimiento/save",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(r)});if(!a.ok)throw console.error("Error saving new record:",a),new Error("Error saving new record");d()}catch(a){console.error("Error saving new record:",a)}},d=async()=>{try{const t=await fetch(`http://localhost:8080/registroRendimiento/todosRegistrosVehiculo/${i}`,{method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}});if(!t.ok)throw console.error("Error fetching performance records:",t),new Error("Error fetching performance records");const r=await t.json();u(r)}catch(t){console.error("Error fetching performance records:",t)}};return o.useEffect(()=>{(async()=>{try{const a=(b=>{const m=`; ${document.cookie}`.split(`; ${b}=`);if(m.length===2)return m.pop()?.split(";").shift()})("jwtToken");if(!a)throw new Error("No token found in cookies");const l=await fetch("http://localhost:8080/vehiculo/obtenerVehiculosPorUsuario",{method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Authorization:`Bearer ${a.trim()}`}});if(!l.ok)throw console.error("Error fetching options:",l),new Error("Error fetching options");const y=await l.json();p(y)}catch(r){console.error("Error fetching options:",r)}})()},[]),o.useEffect(()=>{i&&d()},[i]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Option"}),e.jsxs("select",{title:"Select Option",value:i,onChange:t=>x(t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select an option"}),h.map(t=>e.jsx("option",{value:t.idVehiculo,children:t.marca+" "+t.modelo},t.idVehiculo))]})]})}),e.jsxs("form",{className:"space-y-6",onSubmit:g,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Distance Traveled (km)"}),e.jsx("input",{type:"number",title:"Distance Traveled (km)",placeholder:"Insert distance traveled in kilometers",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",name:"kilometraje",value:s.kilometraje,onChange:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Starting Battery Level (%)"}),e.jsx("input",{type:"number",title:"Starting Battery Level (%)",placeholder:"Insert starting battery level in percentage",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",name:"bateriaInicial",value:s.bateriaInicial,onChange:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ending Battery Level (%)"}),e.jsx("input",{type:"number",title:"Ending Battery Level (%)",placeholder:"Insert ending battery level in percentage",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",name:"bateriaFinal",value:s.bateriaFinal,onChange:c})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Save New Efficency Record"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Performance Metrics"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enter values above to calculate efficiency"})]}),e.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:e.jsxs("table",{className:"min-w-full min-h-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-[#0891b2] hover:bg-cyan-500",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Register Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Kilometers Traveled (km)"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Initial Battery Level (%)"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Final Battery Level (%)"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Performance (km/kWh)"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(t.fecha).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.kilometraje}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.bateriaInicial}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.bateriaFinal}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.rendimiento})]},r))})]})}),e.jsxs("div",{className:"bg-[#16a34a] p-4 rounded-lg text-white",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Average Vehicle Performance"}),e.jsxs("p",{className:"text-2xl font-bold",children:[n.length>0?(n.reduce((t,r)=>t+r.rendimiento,0)/n.length).toFixed(2):"0.00 ","km/kWh"]})]})]})};export{k as default};
