import{j as e}from"./jsx-runtime.ojTTAiD7.js";import{r as d}from"./index.Dck49-wq.js";import{E as x}from"./ErrorMessageForm.Ct9yi1Us.js";const j=({bestRecommendedVehicle:r,title:i})=>{const s=Math.floor(Math.random()*101);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:i}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("img",{src:r.imageURL,alt:`${r.marca} ${r.modelo}`,className:"h-56 w-full object-cover object-center"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[r.marca," ",r.modelo]}),e.jsx("p",{className:"text-sm text-gray-500",children:r.clasificacion})]}),e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s,"% Match"]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Price"}),e.jsx("p",{className:"mt-1 text-lg font-medium text-gray-900",children:r.precio})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Autonomy"}),e.jsxs("p",{className:"mt-1 text-lg font-medium text-gray-900",children:[r.autonomia," km"]})]})]})]})]})})]})},N=()=>{const[r,i]=d.useState({vehicleType:"",budget:""}),[s,c]=d.useState({}),[m,g]=d.useState(null),h=l=>{const{name:u,value:o}=l.target;i({...r,[u]:o})},p=async l=>{l.preventDefault(),c({});const o=(t=>{const a=`; ${document.cookie}`.split(`; ${t}=`);if(a.length===2)return a.pop()?.split(";").shift()})("jwtToken");if(!o){c({general:"No token found in cookies"});return}const f={clasificacionVehiculo:r.vehicleType,presupuesto:r.budget};try{const t=await fetch("http://localhost:8080/preferenciaUsuario/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.trim()}`},body:JSON.stringify(f)});if(!t.ok)throw console.error("Error saving data:",t),new Error("Error saving data");const n=await fetch("http://localhost:8080/preferenciaUsuario/recomendarVehiculo",{method:"GET",headers:{Authorization:`Bearer ${o.trim()}`}});if(!n.ok)throw console.error("Error fetching recommendations:",n),new Error("Error fetching recommendations");const a=await n.json();console.log("Recommendations: ",a),g(a)}catch(t){console.error("Error:",t),c({general:"Failed to fetch recommendations"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{className:"space-y-6",onSubmit:p,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vehicleType",className:"block text-sm font-medium text-gray-700",children:"Preferred Vehicle Type"}),e.jsxs("select",{id:"vehicleType",name:"vehicleType",value:r.vehicleType,onChange:h,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"SEDAN",children:"Sedan"}),e.jsx("option",{value:"SUV",children:"SUV"}),e.jsx("option",{value:"both",children:"No Preference"})]}),s.vehicleType&&e.jsx(x,{errorMessage:s.vehicleType})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"budget",className:"block text-sm font-medium text-gray-700",children:"Budget"}),e.jsx("input",{title:"budget",type:"number",id:"budget",name:"budget",value:r.budget,onChange:h,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"}),s.budget&&e.jsx(x,{errorMessage:s.budget})]})]}),s.general&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mt-5",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:s.general})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Get Recommendations"})})]}),m&&e.jsx(j,{title:"Recommended Vehicle",bestRecommendedVehicle:m})]})};export{N as default};
